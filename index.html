<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <title>
        Lab-Dit Gestor de acceso remoto
    </title>
    <link rel="stylesheet" type="text/css" href="/labo_sphere/web/libs/jquery-easyui-1.9.5/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="/labo_sphere/web/libs/jquery-easyui-1.9.5/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="/labo_sphere/web/libs/jquery-easyui-1.9.5/demo/demo.css">
    <link rel="stylesheet" type="text/css" href="/labo_sphere/web/css/style.css">
    <script type="text/javascript" src="/labo_sphere/web/libs/jquery-easyui-1.9.5/jquery.min.js"></script>
    <script type="text/javascript" src="/labo_sphere/web/libs/jquery-easyui-1.9.5/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="/labo_sphere/web/libs/easyui-patches.js"></script>
    <script type="text/javascript" src="/labo_sphere/web/libs/actions.js"></script>
    <script type="text/javascript">

        function initialize() {
            $('#sesion_host').textbox({
                value:'',
                validType:"regexp['^l[0-9]{3}$']",
                invalidMessage:'Enter valid host name. i.e: l067',
                height:20,
                onChange: function() {
                    if ($('#sesion_host').textbox('isValid')) $('#sesion_hostrb').prop("checked",true);
                    else $('#sesion_host').textbox('setValue',''); // invalid value: clear and forget
                }
            });
            $('#formulario').form('clear');
            $('#duration').combobox({
                height:20,
                width:120,
                panelHeight:'auto',
                value:'7200'
            });
            $('#virtual').combobox({
                height:18,
                width:150,
                panelHeight:'auto',
                value:'ftel'
            });
            $('#labo').combobox({
                height:18,
                width:150,
                panelHeight:'auto',
                value:'laboA'
            });
            $('#username').textbox({
                prompt: 'User name',
                iconCls:'icon-man'
            });
            $('#password').passwordbox({
                prompt: 'Password',
                showEye: true
            });
            addTooltip($('#icon_desktop').linkbutton(), "Desplegar un escritorio remoto (entorno gr√°fico)<br/> en el equipo seleccionado abriendo una nueva ventana del navegador");
            addTooltip($('#icon_terminal').linkbutton(), "Desplegar un terminal tipo texto (ssh)<br/> en una nueva ventana del navegador");
            addTooltip($('#icon_tunel').linkbutton(), "Permitir acceso directo ( ssh o vnc )<br/> desde el ordenador del alumno al equipo del laboratorio seleccionado");
        }

        function selectSession(sesion) {
            if (sesion!=='hostrb') $('#sesion_host').textbox('setValue','');
            $('#virtual_span').css('display',(sesion==='newvm')?'inline-block':'none');
            $('#labo_span').css('display',(sesion==='labo')?'inline-block':'none');
            // as setValue fires up activate hostrb radiobutton, need to properly set
            $('#sesion_'+sesion).prop("checked",true);
            return false; // do not continue chain event
        }

        function acceder(tipo) {
            // if ok then ask for selected session/option
            var username=$('#username').textbox('getValue');
            var password=$('#password').passwordbox('getValue');
            var duration=$('#duration').combobox('getValue');
            if (username==="" || password==="") {
                $.messager.alert("Error","Debe indicar usuario y contrase&ntilde;a","error");
                return;
            }
            var mode=$('input:radio[name=sesion]:checked').val();
            if (mode==="admin") {
                $('#formulario').submit();
                return;
            }
            labo_session(mode,tipo,duration);
        }

    </script>
</head>

<body onload="initialize()">
<form id="formulario" method="POST" action="web/admin.php" >
<div id="cc" class="easyui-layout" style="width:100%;height:768px;">
    <div data-options="region:'north',title:'',split:true" style="height:170px;background: url('web/images/cdcTitle.png') no-repeat left top">
        <p style="font-size:1.6vw;font-style:oblique;font-weight:bold;text-align:right;position:absolute;bottom:3px; right:25px">
            Servicio de acceso remoto a los laboratorios docentes
        </p>
    </div>

    <div data-options="region:'center',title:'Introducci&oacute;n de datos'" style="padding:5px 5px 5px 20px;background:#eee;">

        <h2>
            <span style="display:inline-block;width:40%;text-align:left">Seleccione opci&oacute;n:</span>
            <span style="display:inline-block;width:50%;text-align:right">
                <label for="duration">Duraci&oacute;n:</label>
                <select id="duration" name="duration" class="easyui-combobox">
                    <option value="7200">2 horas</option>
                    <option value="14400" selected="selected">4 horas</option>
                    <option value="21600">6 horas</option>
                    <option value="28800">8 horas</option>
                    <option value="0">Cerrar sesi&oacute;n</option>
                </select>
            </span>
        </h2>
            <input type="hidden" name="host" id="session_host" value=""/>
            <ul style="list-style-type:none">
                <li><input type="radio" name="sesion" id="sesion_labo" value="labo"  onclick="selectSession('labo');"/>
                    <label for="sesion_labo">Acceso a equipos del laboratorio</label>
                    <span id="labo_span" style="text-align:center;display:none">
                        <select id="labo" name="virtual" class="easyui-combobox">
                            <option value="laboA" selected="selected">Lab. Edificio A</option>
                            <option value="laboB" >Lab. Edificio B</option>
                            <option value="mac">Equipos Mac-OSX</option>
                            <option value="virtual">Puestos virtuales</option>
                        </select>
                    </span>
                </li>
                <li><input type="radio" name="sesion" id="sesion_newvm" value="newvm"  onclick="selectSession('newvm');"/>
                    <label for="sesion_newvm">Desplegar una m&aacute;quina virtual</label>
                    <span id="virtual_span" style="text-align:center;display:none">
                        <select id="virtual" name="virtual" class="easyui-combobox">
                            <option value="ftel" selected="selected">Ubuntu FTEL</option>
                            <option value="mac">Mac OSX-Catalina</option>
                            <option value="windows10">Windows 10 Pro</option>
                        </select>
                    </span>
                </li>
                <li><input type="radio" name="sesion" id="sesion_hostrb" value="host" onclick="selectSession('hostrb');"/>
                    <label for="sesion_host">Acceso al equipo:</label>
                    <input name="host" value="" id="sesion_host" size="4" maxlength="4"/>
                </li>
                <li><input type="radio" name="sesion" id="sesion_admin" value="admin" onclick="selectSession('admin');"/>
                    <label for="sesion_admin">Acceso (restringido) al interfaz de gesti&oacute;n</label>
                </li>
            </ul>

        <h2>
            Identificaci&oacute;n:
        </h2>
        <p>
            Por favor: introduzca los credenciales de su cuenta del laboratorio<br/>
            Si no tiene cuenta, o no recuerda la contrase&ntilde;a, pulse <a href="http://www.lab.dit.upm.es/labng">aqu&iacute;</a>
            <br/>&nbsp;<br/>
            <span style="display:inline-block;width:400px;text-align:right;padding-right:10px">
                <label for="username">Nombre de usuario</label>
                <input type="text" name="username" id="username" value=""/> <br/>
                <label for="password">Contrase&ntilde;a</label>
                <input type="password" name="password" id="password" value=""/>
            </span>
            <span style="display:inline-block;width:200px;text-align:left;padding-left:10px">
                <input type="button" onclick="acceder(tunel);" value="Acceder"/>
            </span>
        </p>

    </div>

    <div data-options="region:'east',title:'Conexiones',split:true,href:'web/sesion_info.php'" style="width:35%;padding:10px">
        <p>
            No se ha iniciado sesi&oacute;n
        </p>
    </div>

    <div data-options="region:'south',title:'Instrucciones de acceso',split:true,href:'web/instrucciones.php'" style="height:30%;padding:10px">
        <h2>Instrucciones de acceso</h2>
    </div>
</div>

</form>
<footer>
    <br/>
    Esta p&aacute;gina NO utiliza cookies. Consulte las condiciones generales de acceso y uso del laboratorio en:
    <a href="https://www.lab.dit.upm.es/labng/pdf/normas.pdf">https://www.lab.dit.upm.es/labng/pdf/normas.pdf</a>
    <hr/>
    P&aacute;gina principal del <a href="http://www.lab.dit.upm.es">Laboratorio</a><br/>
    P&aacute;gina web del <a href="http://www.dit.upm.es">Departamento</a>
</footer>
</body>
</html>